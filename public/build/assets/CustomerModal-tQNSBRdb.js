import{d as k,A as w,w as E,c as d,g as l,j as U,f as r,t as p,n as m,u as t,B as i,D as N,C as u,o as a}from"./app-CZGxpMu4.js";import{a as D}from"./AppLayout.vue_vue_type_script_setup_true_lang-fsc1CXWY.js";const V={class:"flex items-center justify-between"},R={class:"text-lg font-semibold"},I={class:"grid grid-cols-2 gap-2"},M={class:"grid md:grid-cols-2 gap-3"},$={key:0,class:"text-xs text-red-600"},B={key:0,class:"text-xs text-red-600"},z={class:"md:col-span-2"},S={key:0,class:"text-xs text-red-600"},j={key:0,class:"text-xs text-red-600"},T={class:"md:col-span-2"},A={class:"md:col-span-2"},F={class:"flex items-center justify-end gap-2 pt-3 border-t mt-1"},P=k({__name:"CustomerModal",props:{open:{type:Boolean},mode:{},customer:{}},emits:["close","saved","updated"],setup(g,{emit:v}){const c=g,b=v,y=()=>c.mode==="edit",e=w({id:null,type:"company",document_type:"RUC",document_number:"",name:"",email:"",phone:"",address:"",notes:"",is_active:!0});function x(){return e.clearErrors(),e.document_number.trim()?(e.document_type==="DNI"&&!/^\d{8}$/.test(e.document_number)&&e.setError("document_number","El DNI debe tener 8 dígitos numéricos"),e.document_type==="RUC"&&!/^\d{11}$/.test(e.document_number)&&e.setError("document_number","El RUC debe tener 11 dígitos numéricos")):e.setError("document_number","Ingrese el número de identificación"),e.name.trim()||e.setError("name","El nombre es obligatorio"),e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&e.setError("email","Correo inválido"),!e.hasErrors}E(()=>c.customer,n=>{n&&(e.id=n.id,e.type=n.type??"company",e.document_type=n.document_type??"RUC",e.document_number=n.document_number??"",e.name=n.name??"",e.email=n.email??"",e.phone=n.phone??"",e.address=n.address??"",e.notes=n.notes??"",e.is_active=!!n.is_active)},{immediate:!0});function _(){x()&&e.post("/customers",{onSuccess:()=>{b("saved"),e.reset()}})}function C(){x()&&e.id&&e.put(`/customers/${e.id}`,{onSuccess:()=>{b("updated")}})}function f(){b("close")}return(n,o)=>c.open?(a(),d("div",{key:0,class:"fixed inset-0 bg-black/40 z-50 grid place-items-center",onClick:U(f,["self"])},[r("div",{class:m(["bg-white w-full max-w-2xl rounded-xl shadow-xl border p-6 space-y-5 animate-fade",{"animate-shake":t(e).hasErrors}])},[r("div",V,[r("h3",R,p(y()?"Editar contacto":"Nuevo contacto"),1),r("button",{class:"opacity-70 hover:opacity-100",onClick:f},"✕")]),r("div",I,[r("button",{class:m(["px-4 py-2 rounded-lg border font-medium",t(e).type==="person"?"bg-primary/10 border-primary text-primary":"hover:bg-muted/40"]),onClick:o[0]||(o[0]=s=>{t(e).type="person",t(e).document_type="DNI",t(e).document_number=""})}," Persona ",2),r("button",{class:m(["px-4 py-2 rounded-lg border font-medium",t(e).type==="company"?"bg-primary/10 border-primary text-primary":"hover:bg-muted/40"]),onClick:o[1]||(o[1]=s=>{t(e).type="company",t(e).document_type="RUC",t(e).document_number=""})}," Empresa ",2)]),r("div",M,[r("div",null,[o[10]||(o[10]=r("label",{class:"block text-sm font-medium mb-1"},"Tipo de identificación *",-1)),i(r("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>t(e).document_type=s),class:m(["w-full border rounded-lg px-2 py-2",t(e).errors.document_type?"border-red-500":""])},[...o[9]||(o[9]=[r("option",{value:"RUC"},"RUC",-1),r("option",{value:"DNI"},"DNI",-1)])],2),[[N,t(e).document_type]]),t(e).errors.document_type?(a(),d("p",$,p(t(e).errors.document_type),1)):l("",!0)]),r("div",null,[o[11]||(o[11]=r("label",{class:"block text-sm font-medium mb-1"},"Número *",-1)),i(r("input",{"onUpdate:modelValue":o[3]||(o[3]=s=>t(e).document_number=s),class:m(["w-full border rounded-lg px-3 py-2",t(e).errors.document_number?"border-red-500":""]),autocomplete:"off"},null,2),[[u,t(e).document_number]]),t(e).errors.document_number?(a(),d("p",B,p(t(e).errors.document_number),1)):l("",!0)]),r("div",z,[o[12]||(o[12]=r("label",{class:"block text-sm font-medium mb-1"},"Razón social / Nombre *",-1)),i(r("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>t(e).name=s),class:m(["w-full border rounded-lg px-3 py-2",t(e).errors.name?"border-red-500":""]),autocomplete:"name"},null,2),[[u,t(e).name]]),t(e).errors.name?(a(),d("p",S,p(t(e).errors.name),1)):l("",!0)]),r("div",null,[o[13]||(o[13]=r("label",{class:"block text-sm font-medium mb-1"},"Correo",-1)),i(r("input",{"onUpdate:modelValue":o[5]||(o[5]=s=>t(e).email=s),class:m(["w-full border rounded-lg px-3 py-2",t(e).errors.email?"border-red-500":""]),autocomplete:"email"},null,2),[[u,t(e).email]]),t(e).errors.email?(a(),d("p",j,p(t(e).errors.email),1)):l("",!0)]),r("div",null,[o[14]||(o[14]=r("label",{class:"block text-sm font-medium mb-1"},"Teléfono",-1)),i(r("input",{"onUpdate:modelValue":o[6]||(o[6]=s=>t(e).phone=s),class:"w-full border rounded-lg px-3 py-2",autocomplete:"tel"},null,512),[[u,t(e).phone]])]),r("div",T,[o[15]||(o[15]=r("label",{class:"block text-sm font-medium mb-1"},"Dirección",-1)),i(r("input",{"onUpdate:modelValue":o[7]||(o[7]=s=>t(e).address=s),class:"w-full border rounded-lg px-3 py-2",autocomplete:"street-address"},null,512),[[u,t(e).address]])]),r("div",A,[o[16]||(o[16]=r("label",{class:"block text-sm font-medium mb-1"},"Notas",-1)),i(r("textarea",{"onUpdate:modelValue":o[8]||(o[8]=s=>t(e).notes=s),rows:"3",class:"w-full border rounded-lg px-3 py-2"},null,512),[[u,t(e).notes]])])]),r("div",F,[r("button",{class:"px-3 py-2 rounded border",onClick:f},"Cancelar"),y()?l("",!0):(a(),d("button",{key:0,class:"px-4 py-2 rounded bg-primary text-white",onClick:_}," Crear contacto ")),y()?(a(),d("button",{key:1,class:"px-4 py-2 rounded bg-primary text-white",onClick:C}," Actualizar ")):l("",!0)])],2)])):l("",!0)}}),H=D(P,[["__scopeId","data-v-e78b20bd"]]);export{H as C};
