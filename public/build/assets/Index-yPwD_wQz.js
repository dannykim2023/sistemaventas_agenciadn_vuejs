import{d as F,r as y,w as E,a as i,c as S,b,u as g,h as V,e as o,f as a,n as d,t as n,i as u,F as D,o as N}from"./app-CZGxpMu4.js";import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-fsc1CXWY.js";import{d as T}from"./index-C4J_hXM0.js";import{_ as B}from"./BaseTable.vue_vue_type_script_setup_true_lang-Cp6dmSHz.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-59Mo48T7.js";import"./useForwardExpose-C9xLoNo1.js";import"./VisuallyHidden-CyaeyaAO.js";import"./RovingFocusGroup-Dongv5Iv.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./createLucideIcon-BIN8wtFf.js";const z={class:"p-4 md:p-6 space-y-4"},I={class:"flex items-center justify-between"},L={class:"border-b"},U={class:"-mb-px flex gap-6"},j={class:"bg-white dark:bg-card rounded-xl shadow-sm border"},q={class:"font-mono text-xs"},M={class:"flex items-center gap-2"},R={class:"w-6 h-6 rounded-full bg-primary/10 text-primary grid place-items-center text-xs font-semibold"},G={class:"font-medium"},H=["onClick"],se=F({__name:"Index",props:{sales:{},filters:{}},setup(v){const l=v,x=r=>{window.open(`/sales/${r}/pdf`,"_blank","noopener")};function c(r,t){const e=Number(r||0),p=t||"PEN";try{return new Intl.NumberFormat("es-PE",{style:"currency",currency:p,minimumFractionDigits:2}).format(e)}catch{return`${p==="USD"?"$":"S/"} ${e.toFixed(2)}`}}function _(r){switch(r){case"issued":return"Emitida";case"partial":return"Parcial";case"paid":return"Pagada";case"cancelled":return"Anulada";default:return r||"—"}}const h=[{title:"Dashboard",href:T().url},{title:"Ventas",href:"/sales"}],m=y(l.filters?.search??""),s=y(l.filters?.status??"all");E(s,f);function f(){i.get("/sales",{search:m.value||void 0,status:s.value!=="all"?s.value:void 0},{preserveState:!0,replace:!0})}function k(r){m.value=r,f()}function $(r){i.get("/sales",{page:r,search:m.value||void 0,status:s.value!=="all"?s.value:void 0},{preserveState:!0,replace:!0})}const C=[{key:"document",label:"Documento"},{key:"customer_name",label:"Cliente"},{key:"issue_date",label:"Fecha emisión"},{key:"total",label:"Total"},{key:"paid",label:"Pagado"},{key:"balance",label:"Saldo"},{key:"status",label:"Estado"},{key:"pdf",label:"Contrato PDF"}],P=[{key:"view",label:"Ver detalle"},{key:"edit",label:"Editar"},{key:"delete",label:"Eliminar",variant:"danger"}];function w(r){const{action:t,row:e}=r;if(t==="view"&&i.get(`/sales/${e.id}`),t==="edit"&&i.get(`/sales/${e.id}/edit`),t==="pdf"&&window.open(`/sales/${e.id}/pdf`,"_blank","noopener"),t==="delete"){if(!confirm("¿Seguro que deseas eliminar esta venta? Esta acción no se puede deshacer."))return;i.delete(`/sales/${e.id}`,{preserveScroll:!0})}}return(r,t)=>(N(),S(D,null,[b(g(V),{title:"Ventas"}),b(A,{breadcrumbs:h},{default:o(()=>[a("div",z,[a("div",I,[t[6]||(t[6]=a("div",null,[a("h1",{class:"text-xl font-semibold"},"Ventas"),a("p",{class:"text-sm text-muted-foreground"}," Administra tus documentos de venta, pagos y estados de cobranza. ")],-1)),a("button",{class:"px-4 py-2 rounded-lg bg-primary text-white text-sm",type:"button",onClick:t[0]||(t[0]=e=>g(i).get("/sales/create"))}," + Nueva venta ")]),a("div",L,[a("nav",U,[a("button",{class:d(["py-3 border-b-2",s.value==="all"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"]),onClick:t[1]||(t[1]=e=>s.value="all")}," Todas ",2),a("button",{class:d(["py-3 border-b-2",s.value==="issued"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"]),onClick:t[2]||(t[2]=e=>s.value="issued")}," Emitidas ",2),a("button",{class:d(["py-3 border-b-2",s.value==="pending"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"]),onClick:t[3]||(t[3]=e=>s.value="pending")}," Por cobrar ",2),a("button",{class:d(["py-3 border-b-2",s.value==="paid"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"]),onClick:t[4]||(t[4]=e=>s.value="paid")}," Pagadas ",2),a("button",{class:d(["py-3 border-b-2",s.value==="cancelled"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"]),onClick:t[5]||(t[5]=e=>s.value="cancelled")}," Anuladas ",2)])]),a("div",j,[b(B,{columns:C,rows:l.sales.data,pagination:{currentPage:l.sales.current_page,lastPage:l.sales.last_page,perPage:l.sales.per_page,total:l.sales.total},actions:P,"search-placeholder":"Buscar por número o cliente",onFilter:k,onChangePage:$,onAction:w},{"cell-document":o(({row:e})=>[a("div",q,n(e.series)+"-"+n(e.number),1)]),"cell-customer_name":o(({row:e})=>[a("div",M,[a("div",R,n((e.customer?.name||"C").substring(0,1).toUpperCase()),1),a("span",G,n(e.customer?.name||"—"),1)])]),"cell-issue_date":o(({row:e})=>[u(n(e.issue_date),1)]),"cell-total":o(({row:e})=>[u(n(c(e.total,e.currency)),1)]),"cell-paid":o(({row:e})=>[u(n(c(e.payments_sum_amount,e.currency)),1)]),"cell-balance":o(({row:e})=>[u(n(c((e.total||0)-(e.payments_sum_amount||0),e.currency)),1)]),"cell-status":o(({row:e})=>[a("span",{class:d(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",{"bg-emerald-50 text-emerald-700":e.status==="paid","bg-sky-50 text-sky-700":e.status==="partial","bg-amber-50 text-amber-700":e.status==="issued","bg-rose-50 text-rose-700":e.status==="cancelled","bg-gray-100 text-gray-600":!["paid","partial","issued","cancelled"].includes(e.status)}])},n(_(e.status)),3)]),"cell-pdf":o(({row:e})=>[a("button",{type:"button",class:"px-2 py-1 text-xs rounded-md border border-primary text-primary hover:bg-primary/5",onClick:p=>x(e.id)}," Ver PDF ",8,H)]),_:1},8,["rows","pagination"])])])]),_:1})],64))}});export{se as default};
